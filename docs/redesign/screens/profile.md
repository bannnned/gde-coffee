# Wave 3 Screen Spec: Profile (`/profile`)

Источник:
- `/Users/a1/Desktop/Prog/gde-coffee/frontend/src/pages/ProfileScreen.tsx`
- `/Users/a1/Desktop/Prog/gde-coffee/frontend/src/features/profile/model/useProfileAccount.ts`

## 1. Цель экрана

`Profile` — персональный центр пользователя:
1. Быстро показать текущее состояние аккаунта.
2. Дать прямой доступ к ключевым действиям профиля.
3. Показывать уровень/репутацию понятным и не перегруженным способом.

## 2. Роль в Wave 3

Входит в Wave 3 полностью:
1. Пересборка структуры экрана под современный compact UX.
2. Визуальная миграция в новый дизайн-язык (shadcn-like).
3. Приведение личного кабинета к единому паттерну карточек и действий.

## 3. Состав функциональных блоков (текущее ядро)

1. **Header**
- назад,
- переход в избранные кофейни,
- переход в настройки профиля.

2. **Hero профиля**
- аватар (просмотр + загрузка нового фото),
- имя (редактирование перенесено в `/settings`).

3. **Уровень и прогресс**
- `Lv`, label, очки, количество событий,
- прогресс-бар до следующего уровня.

4. **Выход**
- кнопка logout внизу.

## 4. Пользовательские задачи

1. Поменять фото профиля без лишних шагов.
2. Понять текущий уровень и прогресс.
3. Перейти в избранные кофейни или настройки.
4. Перейти в `/settings` для смены имени/email/пароля и управления соцсетями.

## 5. Ключевые UX-контракты

1. Возврат назад из `/profile`, открытого поверх Discovery, не сбрасывает состояние карты/шторки.
2. Загрузка аватара дает прозрачную обратную связь (`loading/success/error`).
3. Экран не тянет неиспользуемые профилем данные (соцсети/identity list).
4. Ошибка недоступности репутации (например, 404 в старом контуре) не должна пугать пользователя.

## 6. Состояния и edge cases

1. `status=loading`: skeleton/текст загрузки профиля.
2. Неавторизован: CTA входа вместо личного контента.
3. Ошибки аватара: локальные сообщения без разлома компоновки.
4. Репутация недоступна: fallback-значения уровня и тихая деградация.

## 7. Данные и зависимости

API:
1. `GET /api/auth/me`
2. `POST /api/account/profile/avatar/presign`
3. `POST /api/account/profile/avatar/confirm`
4. `GET /api/reputation/me`

Локальные зависимости:
1. `backgroundLocation` overlay-контракт для возврата в Discovery.
2. Auth gate состояния (`loading/authed/unauth`).

## 8. UX-цели редизайна для этого экрана

1. Убрать визуальный шум и второстепенные элементы из первого экрана.
2. Сфокусировать верхнюю часть на 3 вопросах:
- кто я,
- какой мой уровень,
- что я могу сделать дальше.
3. Сделать действия профиля “одного клика” заметными, но не агрессивными.
4. Унифицировать карточки, отступы и интерактивные состояния с остальными экранами волны.

## 9. Что НЕ входит

1. Редизайн главного экрана и settings drawer (Wave 1).
2. Деталка кофейни и фото-flow (Wave 2).
3. Доработка админских страниц (кроме навигационных ссылок на них).

## 10. Definition of Done (для Profile)

1. Пользователь выполняет базовые действия профиля (фото, навигация, logout) без потери контекста.
2. Уровень/прогресс читаются за 2-3 секунды.
3. Состояния `loading/empty/error` покрыты и визуально согласованы.
4. iOS Safari/PWA: safe-area и скролл стабильны.
5. Экран проходит:
- `/Users/a1/Desktop/Prog/gde-coffee/docs/redesign/01-practical-ui-rules.md`
- `/Users/a1/Desktop/Prog/gde-coffee/docs/redesign/01a-practical-ui-rubric.md` (>= 17/20)

## 11. Smoke-сценарии для приемки

1. Пользователь загружает новый аватар и сразу видит обновление.
2. Пользователь открывает профиль из Discovery и возвращается назад без сброса состояния карты.
3. Пользователь открывает `/settings` из профиля и возвращается обратно без потери контекста.
4. Пользователь нажимает logout и корректно возвращается на главный экран.
